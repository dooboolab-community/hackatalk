(self.webpackChunkhackatalk_website=self.webpackChunkhackatalk_website||[]).push([[7003],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return d},kt:function(){return m}});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=r.createContext({}),l=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},d=function(e){var n=l(e.components);return r.createElement(c.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),u=l(t),m=a,h=u["".concat(c,".").concat(m)]||u[m]||p[m]||i;return t?r.createElement(h,s(s({ref:n},d),{},{components:t})):r.createElement(h,s({ref:n},d))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,s=new Array(i);s[0]=u;var o={};for(var c in n)hasOwnProperty.call(n,c)&&(o[c]=n[c]);o.originalType=e,o.mdxType="string"==typeof e?e:a,s[1]=o;for(var l=2;l<i;l++)s[l]=t[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},9893:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return s},contentTitle:function(){return o},metadata:function(){return c},toc:function(){return l},default:function(){return p}});var r=t(2122),a=t(9756),i=(t(7294),t(3905)),s={id:"direct-messaging",title:"Direct messaging",sidebar_label:"Direct messaging"},o=void 0,c={unversionedId:"client/direct-messaging",id:"client/direct-messaging",isDocsHomePage:!1,title:"Direct messaging",description:"If we want to chat with the user from the pop-up modal shown above,  you might find trouble when thinking of the message screen shown below. This is because you will come up with the scenario of revealing the Message screen in two different cases.",source:"@site/docs/client/start-direct-messaging.md",sourceDirName:"client",slug:"/client/direct-messaging",permalink:"/docs/client/direct-messaging",editUrl:"https://github.com/dooboolab/hackatalk/tree/master/website/docs/client/start-direct-messaging.md",version:"current",frontMatter:{id:"direct-messaging",title:"Direct messaging",sidebar_label:"Direct messaging"},sidebar:"docs",previous:{title:"Search users",permalink:"/docs/client/search-users"}},l=[{value:"Message screen",id:"message-screen",children:[]}],d={toc:l};function p(e){var n=e.components,t=(0,a.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("img",{width:"220",alt:"start-chatting",src:"https://user-images.githubusercontent.com/27461460/92318266-8f400000-f044-11ea-873f-96145e5645e4.png"}),(0,i.kt)("p",null,"If we want to chat with the user from the pop-up modal shown above,  you might find trouble when thinking of the message screen shown below. This is because you will come up with the scenario of revealing the ",(0,i.kt)("inlineCode",{parentName:"p"},"Message")," screen in two different cases."),(0,i.kt)("img",{width:"220",alt:"message",src:"https://user-images.githubusercontent.com/27461460/92318281-cadaca00-f044-11ea-9acf-bae1ddd448f6.png"}),(0,i.kt)("h2",{id:"message-screen"},"Message screen"),(0,i.kt)("p",null,"When a user enters a message screen, the user can have his or her own ",(0,i.kt)("inlineCode",{parentName:"p"},"channelId")," which has already been created. This point is which I've called two different cases. If the user wants to chat directly from the user modal, the user may not know the ",(0,i.kt)("inlineCode",{parentName:"p"},"channelId")," dedicated to them. Then we might have to think of code to differentiate them."),(0,i.kt)("p",null,"In ",(0,i.kt)("inlineCode",{parentName:"p"},"MainStackNavigator.tsx"),","),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx"},"interface MessageItemChannel {\n  channelId: string;\n}\n\ninterface MessageItemUser {\n  user: User;\n}\n\nexport type MainStackParamList = {\n  default: undefined;\n  MainTab: undefined;\n  Message: MessageItemChannel | MessageItemUser;\n  ProfileUpdate: undefined;\n  SearchUser: undefined;\n  Settings: undefined;\n  ChangePw: undefined;\n  ChannelCreate: undefined;\n  PinchZoomViewPager: undefined;\n};\n")),(0,i.kt)("p",null,"and in ",(0,i.kt)("inlineCode",{parentName:"p"},"Message.tsx"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx"},"const MessageScreen: FC<Props> = (props) => {\n  const { route: { params } } = props;\n\n  let channelId: string;\n  let user: User;\n\n  if ('channelId' in params) {\n    channelId = params.channelId;\n  } else {\n    user = params.user;\n  }\n...\n")),(0,i.kt)("p",null,"In ",(0,i.kt)("inlineCode",{parentName:"p"},"MainStackNavigator.tsx"),", we are sending ",(0,i.kt)("inlineCode",{parentName:"p"},"Message")," screen a params which can be ",(0,i.kt)("inlineCode",{parentName:"p"},"MessageItemChannel")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"MessageItemUser"),". Therefore in ",(0,i.kt)("inlineCode",{parentName:"p"},"Message.tsx"),", we applied type-guard to handle different cases. We wanted to make this simple so we came up with providing an ad-hoc resolver called ",(0,i.kt)("inlineCode",{parentName:"p"},"findOrCreatePrivateChannel")," in our backend. This will return the ",(0,i.kt)("inlineCode",{parentName:"p"},"Channel")," data and fulfill your data to be loaded in the ",(0,i.kt)("inlineCode",{parentName:"p"},"Message")," screen. Therefore, ",(0,i.kt)("inlineCode",{parentName:"p"},"findOrCreatePrivateChannel")," should be called every time before entering the ",(0,i.kt)("inlineCode",{parentName:"p"},"Message")," screen."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"This could be partially handled in client-side to prevent re-fetching.")))}p.isMDXComponent=!0}}]);