# Migration `20201109131631-blocked-users`

This migration has been generated by hyochan at 11/9/2020, 10:16:31 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "hackatalk"."BlockedUser" (
"createdAt" timestamp(3)   DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   DEFAULT CURRENT_TIMESTAMP,
"deletedAt" timestamp(3)   ,
"userId" text   NOT NULL ,
"blockedUserId" text   NOT NULL ,
PRIMARY KEY ("userId","blockedUserId")
)

ALTER TABLE "hackatalk"."BlockedUser" ADD FOREIGN KEY("userId")REFERENCES "hackatalk"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "hackatalk"."BlockedUser" ADD FOREIGN KEY("blockedUserId")REFERENCES "hackatalk"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201002065104-channel-last-message-id..20201109131631-blocked-users
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 enum Gender {
   male
@@ -41,8 +41,9 @@
   profile                Profile?
   notifications          Notification[]          @relation("Notification")
   friends                Friend[]                @relation("Friend")
   memberships            Membership[]            @relation("Membership")
+  blockedUsers           BlockedUser[]           @relation("BlockedUser")
 }
 model Notification {
   id                     Int                     @default(autoincrement()) @id
@@ -75,8 +76,21 @@
   @@id([userId, friendId])
 }
+model BlockedUser {
+  createdAt              DateTime?               @default(now())
+  updatedAt              DateTime?               @default(now()) @updatedAt
+  deletedAt              DateTime?
+
+  userId                 String
+  user                   User                    @relation(fields: [userId], references: [id])
+  blockedUserId          String
+  blockedUser            User                    @relation(name: "BlockedUser", fields: [blockedUserId], references: [id])
+
+  @@id([userId, blockedUserId])
+}
+
 enum MembershipType {
   owner
   admin
   member
```


